var k=(D,v)=>()=>(v||D((v={exports:{}}).exports,v),v.exports);var T=k((I,w)=>{/**
 * @license tga-js 1.1.1
 * Copyright (c) 2013-2020 Vincent Thibault, Inc.
 * License: MIT
 */var b,f;b=void 0,f=function(){function D(v,m){for(var y=0;y<m.length;y++){var e=m[y];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(v,e.key,e)}}return function(){function v(){(function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")})(this,v)}var m,y;return m=v,(y=[{key:"_checkHeader",value:function(){var e=this.header;if(e.imageType===0)throw Error("No data");if(e.hasColorMap){if(e.colorMapLength>256||e.colorMapDepth!==24||e.colorMapType!==1)throw Error("Invalid colormap for indexed type")}else if(e.colorMapType)throw Error("Why does the image contain a palette ?");if(!e.width||!e.height)throw Error("Invalid image size");if(e.pixelDepth!==8&&e.pixelDepth!==16&&e.pixelDepth!==24&&e.pixelDepth!==32)throw Error('Invalid pixel size "'+e.pixelDepth+'"')}},{key:"_decodeRLE",value:function(e,a,i,t){for(var h=new Uint8Array(t),g=new Uint8Array(i),s=0;s<t;){var l=e[a++],c=1+(127&l);if(128&l){for(var u=0;u<i;++u)g[u]=e[a+u];a+=i;for(var n=0;n<c;++n)h.set(g,s),s+=i}else{c*=i;for(var r=0;r<c;++r)h[s+r]=e[a+r];s+=c,a+=c}}return h}},{key:"_getImageData8bits",value:function(e,a,i,t,h,g,s,l,c,u){for(var n=0,r=h;r!==s;r+=g)for(var o=l;o!==u;o+=c,n++){var d=a[n];e[4*(o+t*r)+3]=255,e[4*(o+t*r)+2]=i[3*d+0],e[4*(o+t*r)+1]=i[3*d+1],e[4*(o+t*r)+0]=i[3*d+2]}return e}},{key:"_getImageData16bits",value:function(e,a,i,t,h,g,s,l,c,u){for(var n=0,r=h;r!==s;r+=g)for(var o=l;o!==u;o+=c,n+=2){var d=a[n+0]|a[n+1]<<8;e[4*(o+t*r)+0]=(31744&d)>>7,e[4*(o+t*r)+1]=(992&d)>>2,e[4*(o+t*r)+2]=(31&d)>>3,e[4*(o+t*r)+3]=32768&d?0:255}return e}},{key:"_getImageData24bits",value:function(e,a,i,t,h,g,s,l,c,u){for(var n=0,r=h;r!==s;r+=g)for(var o=l;o!==u;o+=c,n+=3)e[4*(o+t*r)+3]=255,e[4*(o+t*r)+2]=a[n+0],e[4*(o+t*r)+1]=a[n+1],e[4*(o+t*r)+0]=a[n+2];return e}},{key:"_getImageData32bits",value:function(e,a,i,t,h,g,s,l,c,u){for(var n=0,r=h;r!==s;r+=g)for(var o=l;o!==u;o+=c,n+=4)e[4*(o+t*r)+2]=a[n+0],e[4*(o+t*r)+1]=a[n+1],e[4*(o+t*r)+0]=a[n+2],e[4*(o+t*r)+3]=a[n+3];return e}},{key:"_getImageDataGrey8bits",value:function(e,a,i,t,h,g,s,l,c,u){for(var n=0,r=h;r!==s;r+=g)for(var o=l;o!==u;o+=c,n++){var d=a[n];e[4*(o+t*r)+0]=d,e[4*(o+t*r)+1]=d,e[4*(o+t*r)+2]=d,e[4*(o+t*r)+3]=255}return e}},{key:"_getImageDataGrey16bits",value:function(e,a,i,t,h,g,s,l,c,u){for(var n=0,r=h;r!==s;r+=g)for(var o=l;o!==u;o+=c,n+=2)e[4*(o+t*r)+0]=a[n+0],e[4*(o+t*r)+1]=a[n+0],e[4*(o+t*r)+2]=a[n+0],e[4*(o+t*r)+3]=a[n+1];return e}},{key:"open",value:function(e,a){var i=this,t=new XMLHttpRequest;t.responseType="arraybuffer",t.open("GET",e,!0),t.onload=function(){t.status===200&&(i.load(new Uint8Array(t.response)),a&&a())},t.send(null)}},{key:"load",value:function(e){var a=0;if(e.length<18)throw Error("Not enough data to contain header");var i={idLength:e[a++],colorMapType:e[a++],imageType:e[a++],colorMapIndex:e[a++]|e[a++]<<8,colorMapLength:e[a++]|e[a++]<<8,colorMapDepth:e[a++],offsetX:e[a++]|e[a++]<<8,offsetY:e[a++]|e[a++]<<8,width:e[a++]|e[a++]<<8,height:e[a++]|e[a++]<<8,pixelDepth:e[a++],flags:e[a++]};if(i.hasEncoding=i.imageType===9||i.imageType===10||i.imageType===11,i.hasColorMap=i.imageType===9||i.imageType===1,i.isGreyColor=i.imageType===11||i.imageType===3,this.header=i,this._checkHeader(),(a+=i.idLength)>=e.length)throw Error("No data");if(i.hasColorMap){var t=i.colorMapLength*(i.colorMapDepth>>3);this.palette=e.subarray(a,a+t),a+=t}var h=i.pixelDepth>>3,g=i.width*i.height,s=g*h;i.hasEncoding?this.imageData=this._decodeRLE(e,a,h,s):this.imageData=e.subarray(a,a+(i.hasColorMap?g:s))}},{key:"getImageData",value:function(e){var a,i,t,h,g,s,l,c=this.header,u=c.width,n=c.height,r=c.flags,o=c.pixelDepth,d=c.isGreyColor,p=(48&r)>>4;switch(e||(e=document?document.createElement("canvas").getContext("2d").createImageData(u,n):{width:u,height:n,data:new Uint8ClampedArray(u*n*4)}),p===2||p===3?(h=0,g=1,s=n):(h=n-1,g=-1,s=-1),p===2||p===0?(a=0,i=1,t=u):(a=u-1,i=-1,t=-1),o){case 8:l=d?this._getImageDataGrey8bits:this._getImageData8bits;break;case 16:l=d?this._getImageDataGrey16bits:this._getImageData16bits;break;case 24:l=this._getImageData24bits;break;case 32:l=this._getImageData32bits}return l.call(this,e.data,this.imageData,this.palette,u,h,g,s,a,i,t),e}},{key:"getCanvas",value:function(){var e=this.header,a=e.width,i=e.height,t=document.createElement("canvas"),h=t.getContext("2d"),g=h.createImageData(a,i);return t.width=a,t.height=i,h.putImageData(this.getImageData(g),0,0),t}},{key:"getDataURL",value:function(e){return this.getCanvas().toDataURL(e||"image/png")}}])&&D(m.prototype,y),v}()},typeof I=="object"&&typeof w<"u"?w.exports=f():typeof define=="function"&&define.amd?define(f):(b=b||self).TgaLoader=f()});export default T();
